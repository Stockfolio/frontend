{"ast":null,"code":"// HTTP Request\nconst BASE_URL = \"http://localhost:3001\";\nconst SIGNUP_URL = `${BASE_URL}/users`;\nconst LOGIN_URL = `${BASE_URL}/login`;\nconst PERSIST_URL = `${BASE_URL}/auth`;\n\nconst setUserAction = userObj => ({\n  type: \"SET_USER\",\n  payload: userObj\n});\n\nconst clearUserAction = () => ({\n  type: \"CLEAR_USER\",\n  payload: {}\n});\n\nconst newUserToDB = userObj => dispatch => {\n  let config = {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      Accept: \"application/json\"\n    },\n    body: JSON.stringify(userObj)\n  };\n  fetch(SIGNUP_URL, config).then(res => res.json()).then(userData => {\n    dispatch(setUserAction(userData.user));\n    localStorage.setItem(\"token\", userData.token);\n    localStorage.setItem(\"user\", JSON.stringify(userData.user.id));\n  }).catch(error => console.log(error));\n};\n\nconst loginUserToDB = userObj => dispatch => {\n  let config = {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer ${localStorage.token}`,\n      \"Content-Type\": \"application/json\",\n      Accept: \"application/json\"\n    },\n    body: JSON.stringify(userObj)\n  };\n  fetch(LOGIN_URL, config).then(res => res.json()).then(userData => {\n    debugger;\n    dispatch(setUserAction(userData.user));\n    localStorage.setItem(\"token\", userData.token);\n    localStorage.setItem(\"user\", JSON.stringify(userData.user.id));\n  }).catch(error => console.log(error));\n};\n\nconst persistUser = () => dispatch => {\n  let config = {\n    method: \"GET\",\n    headers: {\n      Authorization: `Bearer ${localStorage.token}`\n    }\n  };\n  fetch(PERSIST_URL, config).then(res => res.json()).then(userData => {\n    // debugger;\n    dispatch(setUserAction(userData));\n  }).catch(error => console.log(error));\n};\n\nconst patchUserBalanceToDB = (userObj, stockPrice) => dispatch => {\n  let userBalance = userObj.balance - stockPrice;\n  let config = {\n    method: \"PATCH\",\n    headers: {\n      Authorization: `Bearer ${localStorage.token}`,\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify({\n      balance: userBalance\n    })\n  };\n  fetch(`${SIGNUP_URL}/${userObj.id}`, config).then(res => res.json()).then(userData => dispatch(setUserAction(userData))).catch(error => console.log(error));\n};\n\nconst logoutUser = () => dispatch => {\n  dispatch(clearUserAction());\n  localStorage.clear();\n};\n\nexport default {\n  newUserToDB,\n  loginUserToDB,\n  persistUser,\n  logoutUser,\n  patchUserBalanceToDB\n};","map":{"version":3,"sources":["/Users/hamidoudiallo/Desktop/react_projects/portfolio_stocks/frontend/src/redux/actions/loginActions.js"],"names":["BASE_URL","SIGNUP_URL","LOGIN_URL","PERSIST_URL","setUserAction","userObj","type","payload","clearUserAction","newUserToDB","dispatch","config","method","headers","Accept","body","JSON","stringify","fetch","then","res","json","userData","user","localStorage","setItem","token","id","catch","error","console","log","loginUserToDB","Authorization","persistUser","patchUserBalanceToDB","stockPrice","userBalance","balance","logoutUser","clear"],"mappings":"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","sourcesContent":["// HTTP Request\nconst BASE_URL = \"http://localhost:3001\";\nconst SIGNUP_URL = `${BASE_URL}/users`;\nconst LOGIN_URL = `${BASE_URL}/login`;\nconst PERSIST_URL = `${BASE_URL}/auth`;\n\nconst setUserAction = (userObj) => ({\n\ttype: \"SET_USER\",\n\tpayload: userObj,\n});\n\nconst clearUserAction = () => ({\n\ttype: \"CLEAR_USER\",\n\tpayload: {},\n});\n\nconst newUserToDB = (userObj) => (dispatch) => {\n\tlet config = {\n\t\tmethod: \"POST\",\n\t\theaders: {\n\t\t\t\"Content-Type\": \"application/json\",\n\t\t\tAccept: \"application/json\",\n\t\t},\n\t\tbody: JSON.stringify(userObj),\n\t};\n\tfetch(SIGNUP_URL, config)\n\t\t.then((res) => res.json())\n\t\t.then((userData) => {\n\t\t\tdispatch(setUserAction(userData.user));\n\t\t\tlocalStorage.setItem(\"token\", userData.token);\n\t\t\tlocalStorage.setItem(\"user\", JSON.stringify(userData.user.id));\n\t\t})\n\t\t.catch((error) => console.log(error));\n};\n\nconst loginUserToDB = (userObj) => (dispatch) => {\n\tlet config = {\n\t\tmethod: \"POST\",\n\t\theaders: {\n\t\t\tAuthorization: `Bearer ${localStorage.token}`,\n\t\t\t\"Content-Type\": \"application/json\",\n\t\t\tAccept: \"application/json\",\n\t\t},\n\t\tbody: JSON.stringify(userObj),\n\t};\n\tfetch(LOGIN_URL, config)\n\t\t.then((res) => res.json())\n\t\t.then((userData) => {\n\t\t\tdebugger;\n\t\t\tdispatch(setUserAction(userData.user));\n\t\t\tlocalStorage.setItem(\"token\", userData.token);\n\t\t\tlocalStorage.setItem(\"user\", JSON.stringify(userData.user.id));\n\t\t})\n\t\t.catch((error) => console.log(error));\n};\n\nconst persistUser = () => (dispatch) => {\n\tlet config = {\n\t\tmethod: \"GET\",\n\t\theaders: {\n\t\t\tAuthorization: `Bearer ${localStorage.token}`,\n\t\t},\n\t};\n\n\tfetch(PERSIST_URL, config)\n\t\t.then((res) => res.json())\n\t\t.then((userData) => {\n\t\t\t// debugger;\n\t\t\tdispatch(setUserAction(userData));\n\t\t})\n\t\t.catch((error) => console.log(error));\n};\n\nconst patchUserBalanceToDB = (userObj, stockPrice) => (dispatch) => {\n\tlet userBalance = userObj.balance - stockPrice;\n\tlet config = {\n\t\tmethod: \"PATCH\",\n\t\theaders: {\n\t\t\tAuthorization: `Bearer ${localStorage.token}`,\n\t\t\tAccept: \"application/json\",\n\t\t\t\"Content-Type\": \"application/json\",\n\t\t},\n\t\tbody: JSON.stringify({\n\t\t\tbalance: userBalance,\n\t\t}),\n\t};\n\tfetch(`${SIGNUP_URL}/${userObj.id}`, config)\n\t\t.then((res) => res.json())\n\t\t.then((userData) => dispatch(setUserAction(userData)))\n\t\t.catch((error) => console.log(error));\n};\n\nconst logoutUser = () => (dispatch) => {\n\tdispatch(clearUserAction());\n\tlocalStorage.clear();\n};\n\nexport default {\n\tnewUserToDB,\n\tloginUserToDB,\n\tpersistUser,\n\tlogoutUser,\n\tpatchUserBalanceToDB,\n};\n"]},"metadata":{},"sourceType":"module"}